/**
 * @package
 * @author  2023 3iPunt <https://www.tresipunt.com/>
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_tipcoll/distribute",["jquery","core/str","core/ajax","core/templates"],(function($,Str,Ajax,Templates){let ACTION_DISTRIBUTE='[data-action="auto-distribute"]',ACTION_NUM_SELECT='[data-action="num-select"]',SERVICES_DISTRIBUTE="mod_tipcoll_distribute";function Distribute(region,cmid){this.node=$(region),this.cmid=cmid,this.node.find(ACTION_DISTRIBUTE).on("click",this.onDistributeClick.bind(this))}return Distribute.prototype.onDistributeClick=function(e){let usersid=this.getUsersID(),numusers=this.node.find(ACTION_NUM_SELECT).val();numusers=parseInt(numusers);const request={methodname:SERVICES_DISTRIBUTE,args:{cmid:this.cmid,usersid:usersid,numusers:numusers}};Ajax.call([request])[0].done((function(response){response.success?location.reload():console.log(response)})).fail((function(fail){console.log(fail)}))},Distribute.prototype.getUsersID=function(e){this.nodeParticipants=$('[data-region="mod_tipcoll-view-page"] [data-region="participants"]');let userids=[];return this.nodeParticipants.find(".participant").each((function(index){let userid=$(this).data("userid");userids.push(userid)})),userids.toString()},Distribute.prototype.node=null,{initDistribute:function(region,cmid){return new Distribute(region,cmid)}}}));

//# sourceMappingURL=distribute.min.js.map